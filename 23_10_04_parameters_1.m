(* ::Package:: *)

Q10Dino={Q10->1.67};
Clear[arr];
w0=28;
arr=Q10^((w-w0)/10);
FvFmpointsCunning = {{30, 0.7}, {30, 0.67}, {32, 0.66}, {32, 0.68}, {33, 0.67}, {33, 0.66}, {34, 0.61}, {34, 0.6}, {35, 0.55}, {35, 0.5}, {36, 0.35}, {36, 0.32}, {37, 0.21}, {37, 0.19}, {38, 0.13}, {38, 0.11}}; 
FvFmpointsBellworthy = {{34.090909090909086, 0.36173245614035093}, {33.97129186602871, 0.40741959064327493}, {34.06698564593301, 0.4531067251461989}, {33.92344497607655, 0.5481359649122808}, {32.0334928229665, 0.5353435672514619}, {32.05741626794258, 0.5234649122807018}, {32.05741626794258, 0.5042763157894736}, {32.05741626794258, 0.4960526315789474}, {31.985645933014347, 0.4768640350877193}, 
    {32.081339712918655, 0.48326023391812867}, {32.05741626794258, 0.46681286549707607}, {31.961722488038273, 0.4558479532163743}, {31.913875598086122, 0.44579678362573105}, {32.05741626794258, 0.4302631578947369}, {32.05741626794258, 0.4028508771929825}, {32.05741626794258, 0.3535087719298246}, {32.081339712918655, 0.335233918128655}, {30.980861244019135, 0.5801169590643275}, 
    {30.980861244019135, 0.5728070175438597}, {31.052631578947363, 0.5636695906432749}, {30.980861244019135, 0.5499634502923977}, {31.028708133971286, 0.5399122807017545}, {31.052631578947363, 0.5271198830409357}, {30.93301435406698, 0.5207236842105263}, {31.07655502392344, 0.48965643274853804}, {31.07655502392344, 0.44945175438596496}, {31.028708133971286, 0.4202119883040936}, 
    {31.052631578947363, 0.40741959064327493}, {30.93301435406698, 0.3690423976608188}, {31.07655502392344, 0.32152777777777786}, {30.071770334928225, 0.5865131578947369}, {29.880382775119614, 0.5773757309941521}, {30.02392344497607, 0.5563596491228071}, {30.095693779904302, 0.5380847953216374}, {29.952153110047842, 0.5298611111111111}, {29.999999999999993, 0.516154970760234}, 
    {30.095693779904302, 0.49788011695906437}, {29.928229665071765, 0.4905701754385965}, {30.02392344497607, 0.4823464912280702}, {30.11961722488038, 0.4439692982456141}, {29.234449760765546, 0.6513888888888889}, {29.25837320574162, 0.6440789473684211}, {29.162679425837318, 0.6312865497076023}, {29.162679425837318, 0.621235380116959}, {29.21052631578947, 0.6084429824561404}, 
    {29.043062200956932, 0.5892543859649123}, {29.06698564593301, 0.5782894736842106}, {29.06698564593301, 0.5654970760233918}, {29.13875598086124, 0.5527046783625731}, {29.13875598086124, 0.538998538011696}, {28.995215311004777, 0.5326023391812866}, {28.995215311004777, 0.5198099415204678}, {28.870813397129186, 0.5114035087719297}, {28.94736842105263, 0.49824561403508766}, 
    {28.94736842105263, 0.48070175438596485}, {28.94736842105263, 0.46754385964912276}, {29.023923444976077, 0.4558479532163742}, {26.995215311004785, 0.581578947368421}, {26.95693779904306, 0.5684210526315789}, {27.11004784688995, 0.5596491228070175}, {26.803827751196174, 0.5581871345029239}, {27.07177033492823, 0.5435672514619883}, {26.842105263157894, 0.5260233918128654}, 
    {27.11004784688995, 0.5216374269005848}, {26.95693779904306, 0.5128654970760234}, {26.842105263157894, 0.4923976608187134}, {26.95693779904306, 0.4485380116959064}, {25.923444976076553, 0.5728070175438595}, {26.153110047846887, 0.5596491228070175}, {24.239234449760765, 0.6122807017543859}, {24.086124401913874, 0.6239766081871344}, {23.971291866028707, 0.6093567251461988}, 
    {24.124401913875598, 0.5947368421052631}, {24.124401913875598, 0.5786549707602339}, {22.401913875598087, 0.5567251461988303}, {22.440191387559807, 0.5391812865497075}, {22.440191387559807, 0.5216374269005848}, {22.440191387559807, 0.48508771929824557}, {22.440191387559807, 0.4719298245614034}, {22.440191387559807, 0.4573099415204678}, {22.440191387559807, 0.44561403508771924}, 
    {22.440191387559807, 0.4309941520467836}, {22.440191387559807, 0.4134502923976608}, {22.32535885167464, 0.3900584795321637}, {22.363636363636363, 0.3739766081871345}, {20.373205741626794, 0.4865497076023391}, {20.60287081339713, 0.4616959064327485}, {20.641148325358852, 0.44707602339181285}, {20.56459330143541, 0.43684210526315786}, {20.56459330143541, 0.42076023391812867}, 
    {20.449760765550238, 0.3944444444444444}, {20.48803827751196, 0.38274853801169584}, {20.411483253588518, 0.3725146198830409}, {20.641148325358852, 0.36081871345029237}, {18.61244019138756, 0.46754385964912276}, {18.688995215311003, 0.4280701754385965}, {18.650717703349283, 0.38859649122807016}, {18.688995215311003, 0.3988304093567251}, {18.688995215311003, 0.35350877192982455}, 
    {18.727272727272727, 0.3374269005847953}, {18.574162679425836, 0.2994152046783626}, {18.688995215311003, 0.25263157894736843}}; 
FvFmpointsCunning2023 = {{28.5, 0.4585}, {31, 0.443}, {33, 0.352}, {34, 0.334}, {35, 0.094}, {36, 0.0265}, {37, 0.0545}, {38, 0}, {28.5, 0.4425}, {31, 0.385}, {33, 0.3645}, {34, 0.275}, {35, 0.136}, {36, 0.098}, {37, 0.0585}, {38, 0.0175}, {28.5, 0.435}, {31, 0.444}, {33, 0.4225}, {35, 0.1675}, {36, 0.0935}, {37, 0}, {38, 0}, {28.5, 0.4245}, {31, 0.437}, {33, 0.3975}, {34, 0.321}, 
     {35, 0.2035}, {36, 0.103}, {37, 0.064}, {38, 0}, {28.5, 0.457}, {31, 0.4725}, {33, 0.521}, {34, 0.4405}, {35, 0.233}, {36, 0.037}, {37, 0}, {38, 0}, {28.5, 0.46}, {31, 0.478}, {33, 0.4635}, {34, 0.418}, {35, 0.232}, {36, 0.094}, {37, 0.0365}, {38, 0.0425}, {28.5, 0.4435}, {31, 0.4265}, {33, 0.3795}, {34, 0.325}, {35, 0.255}, {36, 0.111}, {37, 0}, {38, 0}, {28.5, 0.4205}, {31, 0.441}, 
     {33, 0.454}, {34, 0.421}, {35, 0.247}, {36, 0.106}, {37, 0}, {38, 0.019}, {28.5, 0.4385}, {31, 0.429}, {33, 0.453}, {34, 0.3475}, {36, 0.1195}, {37, 0.071}, {38, 0.036}, {28.5, 0.4165}, {31, 0.4315}, {33, 0.4025}, {34, 0.352}, {35, 0.237}, {36, 0.164}, {37, 0.0845}, {38, 0.052}, {28.5, 0.424}, {31, 0.4475}, {33, 0.4065}, {34, 0.342}, {35, 0.316}, {36, 0.13}, {37, 0.09}, {38, 0}, 
     {28.5, 0.466}, {31, 0.4245}, {33, 0.425}, {34, 0.4335}, {35, 0.297}, {36, 0.14}, {37, 0.0585}, {38, 0.0325}, {28.5, 0.411}, {31, 0.472}, {33, 0.457}, {34, 0.417}, {35, 0.326}, {36, 0.1455}, {37, 0.0335}, {38, 0}, {28.5, 0.438}, {31, 0.44}, {33, 0.455}, {34, 0.429}, {35, 0.327}, {36, 0.158}, {37, 0.0425}, {38, 0}, {28.5, 0.4375}, {31, 0.429}, {33, 0.4585}, {34, 0.392}, {35, 0.378}, 
     {36, 0.112}, {37, 0.014}, {38, 0}, {28.5, 0.4505}, {31, 0.461}, {33, 0.437}, {34, 0.411}, {35, 0.365}, {36, 0.174}, {37, 0}, {38, 0}, {28.5, 0.424}, {31, 0.424}, {33, 0.465}, {34, 0.436}, {35, 0.345}, {37, 0.047}, {38, 0}, {28.5, 0.4555}, {31, 0.465}, {33, 0.4555}, {34, 0.4305}, {35, 0.39}, {36, 0.24}, {37, 0.0445}, {38, 0}, {28.5, 0.475}, {31, 0.4605}, {33, 0.427}, {34, 0.4175}, 
     {35, 0.399}, {36, 0.324}, {37, 0.135}, {38, 0.0455}, {28.5, 0.4555}, {31, 0.4605}, {33, 0.479}, {34, 0.243}, {35, 0.412}, {36, 0.2985}, {37, 0.1665}, {38, 0}};
(*FvFmpoints=Join[FvFmpointsCunning,FvFmpointsBellworthy,FvFmpointsCunning2023];*)
sigmoidFunction=sigmax E^(-steepness(w-ED50))/(1+E^(-steepness(w-ED50)));
FvFmFunc=arr sigmoidFunction;
FvFmpoints=Join[FvFmpointsCunning2023,FvFmpointsBellworthy];
FvFmFIT=NonlinearModelFit[FvFmpoints,{FvFmFunc/.Q10Dino ,steepness>0},{{sigmax,.5},{ED50,37},{steepness,5}},w];
tolerance=sigmoidFunction;
maxjCPmtemp=Quiet@Solve[D[arr tolerance,w]==0,w][[1]];
w0calibrate=w0;
jCPfuncArr=2.8 (arr tolerance)/(arr tolerance/.maxjCPmtemp);
toleranceFIT=FvFmFIT["BestFitParameters"]/.{(ED50->x_)->(ED50->x-4),(sigmax->_)->(sigmax->1)};
jCPfuncNoArr=2.8;
(*Q10 dependent rates*)
Q10dependent={j0HT,j0ST,jXm,jNm,jHGm,jSGm};
parvals=Join[
(*rates increase with temperature*)
#[[1]]->arr #[[2]]&/@{jHGm->1,jNm->0.035`,jSGm->.25,j0HT-> 0.03`,j0ST->0.03`,jXm->0.13`},
(*max photosynthesis decreases with temperature*)
(*{jCPm->jCPfunc(*tolerance 2.8*)},*)
(*other parameters*)
{nNH->0.18`,nNS->0.13`,nNX->0.2`,\[Sigma]NH->0.9`,\[Sigma]CH->0.1`,\[Sigma]NS->0.9`,\[Sigma]CS->0.9`,KX->1/1000000,KN->1.5`*^-6,kCO2->10,yCL->0.1`,yC->0.8`,astar->1.34`,kNPQ->112,OneOverkROS->1/80,b->6,\[Kappa]->0,
X->2 10^-7,\[CapitalNu]->10^-7,L->30,\[Lambda]->1,tmax->365,tmin->-100,S0->.2,H0->1}
];
{
parvalsFvFmArr,
parvalsFvFm,
parvalsArr
}={
Join[Q10Dino,parvals/.Q10Dino,{jCPm->(jCPfuncArr/.toleranceFIT/.Q10Dino)}],
Join[{Q10->1},parvals/.{Q10->1},{jCPm->(jCPfuncArr/.toleranceFIT/.Q10Dino)}],
Join[Q10Dino,parvals/.Q10Dino,{jCPm->2.8}]
};
inivalsdefault={jSG->1,jCP->2.8,H->H0,S->S0};


(* ::Text:: *)
(**)
